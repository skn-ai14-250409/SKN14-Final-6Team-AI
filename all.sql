-- =========================================
-- Qook 신선식품 챗봇: 병합 정규화 SQL (seed + new)
-- =========================================

USE qook_chatbot;

-- --------------------------
-- 사용자 정보
-- --------------------------
INSERT INTO userinfo_tbl (user_id, name, birth_date, email, phone_num, address, post_num) VALUES
('user001', '김신선', '1990-05-15', 'shinsun@email.com', '010-1234-5678', '서울시 강남구 테헤란로 123', '06142'),
('user002', '박건강', '1985-08-20', 'healthy@email.com', '010-2345-6789', '서울시 서초구 서초대로 456', '06651'),
('user003', '이맛있', '1992-12-03', 'delicious@email.com', '010-3456-7890', '부산시 해운대구 해운대로 789', '48094'),
('user004', '최영양', '1988-03-10', 'nutrition@email.com', '010-4567-8901', '대구시 중구 중앙대로 101', '41911'),
('user005', '정유기', '1995-07-25', 'organic@email.com', '010-5678-9012', '인천시 남동구 인주대로 202', '21556'),
('anonymous', '익명사용자', '2000-01-01', 'anonymous@qook.com', '000-0000-0000', '기본주소', '00000');

-- --------------------------
-- 사용자 상세
-- --------------------------
INSERT INTO user_detail_tbl (user_id, gender, age, allergy, vegan, house_hold, unfavorite, membership) VALUES
('user001', 'F', 34, '견과류', 0, 3, '매운음식', 'premium'),
('user002', 'M', 39, NULL, 1, 2, '생선', 'basic'),
('user003', 'F', 32, '복숭아', 0, 4, NULL, 'premium'),
('user004', 'M', 36, NULL, 0, 1, '버섯', 'basic'),
('user005', 'F', 29, '유제품', 1, 2, '육류', 'gold'),
('anonymous', 'M', 25, NULL, 0, 1, NULL, 'basic');

-- --------------------------
-- 카테고리 정의
-- --------------------------
INSERT INTO category_definition_tbl (category_id, category_name) VALUES
(1, '과일'),
(2, '채소'),
(3, '곡물/견과류'),
(4, '육류/수산'),
(5, '유제품'),
(6, '냉동식품'),
(7, '조미료/소스'),
(8, '음료'),
(9, '베이커리'),
(10, '기타');

-- --------------------------
-- 카테고리 상세
-- --------------------------
INSERT INTO category_tbl (item, category_id) VALUES
('사과', 1), ('바나나', 1), ('오렌지', 1), ('딸기', 1), ('포도', 1),
('배', 1), ('레몬', 1), ('키위', 1), ('멜론', 1), ('수박', 1),
('복숭아', 1), ('자두', 1), ('체리', 1), ('망고', 1), ('파인애플', 1),
('양상추', 2), ('상추', 2), ('깻잎', 2), ('시금치', 2), ('케일', 2), ('무', 2),
('대파', 2), ('마늘', 2), ('생강', 2), ('오이', 2), ('호박', 2),
('가지', 2), ('피망', 2), ('고추', 2), ('감자', 2), ('고구마', 2), ('당근', 2),
('콩나물', 2), ('브로콜리', 2), ('양파', 2), ('토마토', 2), ('배추', 2),
('아몬드', 3), ('호두', 3), ('땅콩', 3), ('잣', 3), ('현미', 3),
('귀리', 3), ('퀴노아', 3), ('쌀', 3), ('팥', 3), ('콩', 3), ('보리', 3),
('돼지고기', 4), ('닭고기', 4), ('연어', 4), ('소고기', 4), ('참치', 4),
('새우', 4), ('오징어', 4), ('갈치', 4), ('고등어', 4),
('조개', 4), ('전복', 4), ('문어', 4), ('황태', 4), ('명태', 4),
('우유', 5), ('요거트', 5), ('치즈', 5), ('버터', 5), ('두유', 5),
('냉동만두', 6), ('냉동피자', 6), ('냉동베리', 6), ('냉동브로콜리', 6),
('간장', 7), ('된장', 7), ('고추장', 7), ('참기름', 7), ('올리브오일', 7),
('생수', 8), ('주스', 8), ('차', 8),
('식빵', 9), ('베이글', 9),
('두부', 10), ('달걀', 10), ('김', 10);

-- --------------------------
-- 상품 정보 (seed + new 정규화)
-- --------------------------
INSERT INTO product_tbl (product, item, organic, unit_price, origin, cart_add_count) VALUES
-- seed 데이터
('유기농 사과 1kg', '사과', 'Y', '3000', '국내산', 45),
('사과 1kg', '사과', 'N', '2500', '국내산', 38),
('바나나 1.2kg', '바나나', 'N', '2500', '필리핀산', 67),
('오렌지 2kg 봉', '오렌지', 'N', '4000', '미국산', 32),
('딸기 500g 1팩', '딸기', 'N', '8000', '국내산', 29),
('유기농 딸기 500g 1팩', '딸기', 'Y', '15000', '국내산', 29),
('포도 1kg', '포도', 'N', '6000', '국내산', 25),
('양상추 200g 1봉', '양상추', 'N', '2000', '국내산', 22),
('유기농 당근 1kg', '당근', 'Y', '1800', '국내산', 41),
('당근 1kg', '당근', 'N', '1500', '국내산', 35),
('브로콜리 400g 1송이', '브로콜리', 'N', '3500', '국내산', 28),
('토마토 1kg', '토마토', 'N', '2200', '국내산', 32),
('쌀 10kg', '쌀', 'N', '45000', '국내산', 33),
('현미 5kg', '현미', 'N', '50000', '국내산', 28),
('귀리 1kg', '귀리', 'N', '12000', '캐나다산', 22),
('참치 200g', '참치', 'N', '15000', '국내산', 29),
('새우 300g', '새우', 'N', '20000', '국내산', 29),
('소고기 500g', '소고기', 'N', '35000', '국내산', 25),
('우유 1L', '우유', 'N', '3000', '국내산', 22),
('플레인 요거트 500ml', '요거트', 'N', '4000', '덴마크산', 22),
('크림치즈 200g', '치즈', 'N', '12000', '네덜란드산', 22),
('달걀 30입', '달걀', 'N', '6000', '국내산', 29),
-- new 데이터
('햇 홍로사과 1.3kg 봉', '사과', 'N', '5900', '국내산', 45),
('꿀 부사사과 2kg 봉', '사과', 'N', '7800', '국내산', 38),
('필리핀산 스위티오 바나나 1.2kg', '바나나', 'N', '3500', '필리핀산', 67),
('유기농 바나나 1kg', '바나나', 'Y', '4800', '에콰도르산', 29),
('미국산 허니듀 멜론 1.8kg', '멜론', 'N', '8900', '미국산', 23),
('샤인머스켓 포도 1kg', '포도', 'N', '15800', '국내산', 34),
('제주 한라봉 1.5kg 봉', '오렌지', 'Y', '9800', '국내산', 41),
('배 3kg 봉 (6-8입)', '배', 'N', '11900', '국내산', 27),
('칠레산 체리 500g', '체리', 'N', '18900', '칠레산', 19),
('캘리포니아 오렌지 2kg 봉', '오렌지', 'N', '6800', '미국산', 33),
('성주 참외 1kg', '멜론', 'Y', '7500', '국내산', 28),
('제주 골드키위 1kg (10-12입)', '키위', 'N', '8900', '국내산', 31),
('레몬 500g', '레몬', 'Y', '7800', '국내산', 22),
('태국산 망고 2입', '망고', 'N', '9800', '태국산', 25),
('청송사과 2kg 봉', '사과', 'Y', '8900', '국내산', 36),
('미국산 자몽 4입', '오렌지', 'N', '5900', '미국산', 18),
('햇 복숭아 1.5kg', '복숭아', 'N', '9800', '국내산', 24),
('필리핀산 파인애플 1입', '파인애플', 'N', '4800', '필리핀산', 26),
('일본산 청포도 500g', '포도', 'N', '12800', '일본산산', 15),
('친환경 로메인 상추 200g', '상추', 'Y', '2800', '국내산', 52),
('시금치 200g 1봉', '시금치', 'Y', '1800', '국내산', 48),
('케일 150g', '케일', 'Y', '3200', '국내산', 31),
('제주 브로콜리 400g 1송이', '브로콜리', 'Y', '2500', '국내산', 44),
('햇 당근 1kg', '당근', 'Y', '2200', '국내산', 39),
('무 1.5kg 1입', '무', 'N', '2800', '국내산', 35),
('절단 무 250g (2입)', '무', 'N', '1500', '국내산', 58),
('양파 2kg 봉', '양파', 'N', '3200', '국내산', 73),
('대파 500g 1봉', '대파', 'Y', '3800', '국내산', 41),
('마늘 500g', '마늘', 'N', '8900', '국내산', 32),
('생강 200g', '생강', 'N', '4500', '국내산', 27),
('완숙 토마토 1kg (4-6입)', '토마토', 'N', '5800', '국내산', 49),
('대추방울토마토 500g', '토마토', 'Y', '3800', '국내산', 36),
('오이 3입', '오이', 'N', '2800', '국내산', 43),
('애호박 500g 1봉', '호박', 'N', '2200', '국내산', 38),
('가지 300g 1봉', '가지', 'Y', '2500', '국내산', 29),
('빨강 파프리카 200g 3입', '피망', 'Y', '4800', '국내산', 24),
('청양고추 100g 1봉', '고추', 'N', '2800', '국내산', 33),
('감자 2kg 봉', '감자', 'N', '4500', '국내산', 56),
('햇 고구마 1.5kg', '고구마', 'Y', '3800', '국내산', 42),
('콩나물 300g 1봉', '콩나물', 'N', '1200', '국내산', 67),
('숙주 숙주나물 200g', '콩나물', 'N', '1500', '국내산', 45),
('깻잎 30장', '상추', 'N', '2800', '국내산', 38),
('청경채 300g', '상추', 'N', '2200', '국내산', 31),
('부추 200g', '대파', 'N', '2500', '국내산', 29),
('배추 1포기', '상추', 'N', '3500', '국내산', 51),
('혼합 쌈채소 150g', '상추', 'Y', '3800', '국내산', 34),
('치커리 150g', '상추', 'N', '2800', '국내산', 22),
('적상추 150g', '상추', 'N', '2500', '국내산', 28),
('이천쌀 10kg', '쌀', 'N', '45000', '국내산', 18),
('햇곡 현미 5kg', '현미', 'N', '28000', '국내산', 12),
('유기농 귀리 1kg', '귀리', 'Y', '8900', '캐나다산', 15),
('퀴노아 500g', '퀴노아', 'N', '12800', '페루산', 9),
('무염 생 아몬드 500g', '아몬드', 'N', '9800', '미국산', 22),
('생 호두 300g', '호두', 'N', '15800', '국내산', 14),
('볶음 땅콩 400g', '땅콩', 'N', '5800', '중국산', 19),
('잣 200g', '잣', 'N', '24800', '국내산', 8),
('오곡 혼합곡 1kg', '쌀', 'N', '8900', '국내산', 13),
('검은쌀 흑미 1kg', '쌀', 'N', '12000', '국내산', 11),
('보리 1kg', '귀리', 'N', '5800', '국내산', 10),
('콩 서리태 500g', '콩', 'N', '8900', '국내산', 9),
('팥 500g', '팥', 'N', '7800', '국내산', 8),
('렌틸콩 500g', '콩', 'N', '6800', '캐나다산', 7),
('한우 등심 300g', '소고기', 'N', '28000', '국내산', 32),
('돼지 삼겹살 500g', '돼지고기', 'N', '8900', '국내산', 45),
('닭가슴살 1kg', '닭고기', 'N', '7800', '국내산', 38),
('연어 300g', '연어', 'N', '12800', '노르웨이산', 29),
('참치 참다랑어 사시미용 200g', '참치', 'N', '15800', '국내산', 18),
('새우 흰다리새우 300g', '새우', 'N', '9800', '베트남산', 33),
('오징어 1마리', '오징어', 'N', '5800', '국내산', 25),
('명태 냉동 명태 2마리', '명태', 'N', '8900', '러시아산', 22),
('갈치 1마리', '갈치', 'N', '12800', '국내산', 19),
('고등어 2마리', '고등어', 'N', '6800', '국내산', 27),
('조개 바지락 500g', '조개', 'N', '4800', '국내산', 31),
('전복 5입', '전복', 'N', '18900', '국내산', 15),
('문어 300g', '문어', 'N', '9800', '국내산', 20),
('황태 황태채 200g', '황태', 'N', '12800', '국내산', 12),
('소갈비 500g', '소고기', 'N', '22800', '국내산', 24),
('서울우유 저지방 우유 1L', '우유', 'N', '2800', '국내산', 89),
('매일 플레인 요거트 500ml', '요거트', 'N', '3200', '국내산', 56),
('덴마크 크림치즈 200g', '치즈', 'N', '4800', '덴마크산', 31),
('서울우유 무염버터 200g', '버터', 'N', '5800', '국내산', 24),
('풀무원 달걀 30입', '달걀', 'N', '8900', '국내산', 67),
('정식품 베지밀 두유 1L', '두유', 'N', '3800', '국내산', 43),
('남양 고칼슘 우유 1L', '우유', 'N', '3200', '국내산', 52),
('그리스 플레인 요거트 450g', '요거트', 'N', '5800', '그리스산', 28),
('CJ 비비고 왕교자 1kg', '냉동만두', 'N', '8900', '국내산', 78),
('오뚜기 냉동 불고기피자 380g', '냉동피자', 'N', '4800', '국내산', 45),
('냉동 혼합베리 500g', '냉동베리', 'N', '6800', '폴란드산', 32),
('냉동 브로콜리 500g', '냉동브로콜리', 'N', '3800', '중국산', 28),
('샘표 조선 간장 500ml', '간장', 'N', '3800', '국내산', 41),
('해찬들 된장 500g', '된장', 'N', '4800', '국내산', 35),
('오뚜기 맛있는 참기름 320ml', '참기름', 'N', '8900', '국내산', 29),
('제주삼다수 생수 2L 6입', '생수', 'N', '4800', '국내산', 73),
('델몬트 오렌지주스 1L', '주스', 'N', '3800', '미국산', 42),
('파리바게뜨 식빵 460g', '식빵', 'N', '2800', '국내산', 15);


-- product_tbl에는 있지만 stock_tbl에는 없는 상품 찾기
SELECT p.product
FROM product_tbl p
LEFT JOIN stock_tbl s ON p.product = s.product
WHERE s.product IS NULL;

-- --------------------------
-- 재고 (stock_tbl)
-- --------------------------
INSERT INTO stock_tbl (product, stock)
SELECT product, FLOOR(20 + (RAND() * 130))  -- 20~150 사이 랜덤
FROM product_tbl;

-- --------------------------
-- FAQ
-- --------------------------
INSERT INTO faq_tbl (question, answer, faq_category) VALUES
('배송은 언제 오나요?', '주문 후 1-2일 내에 배송됩니다. 신선식품 특성상 당일배송도 가능합니다.', '배송'),
('배송은 얼마나 걸리나요?', '일반적으로 주문 후 1-2일 내 배송됩니다. 제주/도서산간 지역은 추가 1-2일이 소요될 수 있습니다.', '배송'),
('유기농 인증은 어떻게 확인하나요?', '모든 유기농 상품은 국가 인증마크가 있으며, 상품 상세페이지에서 인증서를 확인하실 수 있습니다.', '상품'),
('반품/교환은 어떻게 하나요?', '신선식품 특성상 단순변심 반품은 어렵지만, 상품 불량 시 즉시 교환 가능합니다.', '교환/반품'),
('환불은 어떻게 하나요?', '구매일로부터 7일 이내에 고객센터로 연락주시면 환불 처리가 가능합니다. 신선식품 특성상 개봉하지 않은 상품에 한합니다.', '환불'),
('배송비는 얼마인가요?', '3만원 이상 구매 시 무료배송, 미만 시 3,000원의 배송비가 부과됩니다.', '배송'),
('알레르기 정보는 어디서 확인하나요?', '각 상품 상세페이지에 알레르기 유발요소가 명시되어 있습니다.', '상품'),
('신선도는 어떻게 보장하나요?', '수확 후 24시간 내 배송하며, 콜드체인 시스템으로 신선도를 유지합니다.', '상품'),
('주문 취소는 어떻게 하나요?', '배송 전까지는 마이페이지에서 취소 가능하며, 이후에는 고객센터로 문의주세요.', '주문'),
('회원가입 혜택이 있나요?', '신규 회원 10% 할인쿠폰과 등급별 적립금 혜택을 제공합니다.', '회원');

-- --------------------------
-- 사용자 로그
-- --------------------------
INSERT INTO userlog_tbl (log_id, user_id, log_time) VALUES
('log001', 'user001', '2024-09-02 09:30:00'),
('log002', 'user002', '2024-09-02 14:20:00'),
('log003', 'user003', '2024-09-02 11:45:00'),
('log004', 'anonymous', '2024-09-02 16:10:00'),
('log005', 'user004', '2024-09-02 08:55:00');

-- --------------------------
-- 대화 히스토리
-- --------------------------
INSERT INTO history_tbl (history_id, log_id, message_text, role, created_time) VALUES
('hist001', 'log001', '안녕하세요! 신선한 사과를 찾고 있어요', 'user', '2024-09-02 09:30:15'),
('hist002', 'log001', '안녕하세요! 햇 홍로사과 1.3kg 봉을 추천드려요. 1kg당 3,000원입니다.', 'bot', '2024-09-02 09:30:20'),
('hist003', 'log001', '좋네요! 2kg 주문하고 싶어요', 'user', '2024-09-02 09:31:00'),
('hist004', 'log002', '유기농 채소 추천해주세요', 'user', '2024-09-02 14:20:10'),
('hist005', 'log002', '친환경 로메인 상추와 햇 당근을 추천드려요. 신선하고 영양가가 높습니다!', 'bot', '2024-09-02 14:20:15');

-- --------------------------
-- 주문
-- --------------------------
-- INSERT INTO order_tbl (order_code, user_id, order_date, total_price, order_status, ) VALUES
-- (1001, 'user001', '2024-09-02', '6000', 'completed'),
-- (1002, 'user002', '2024-09-02', '3500', 'pending'),
-- (1003, 'user003', '2024-09-02', '15000', 'shipped');

INSERT INTO order_tbl (
  order_code, user_id, order_date, total_price, order_status, subtotal, discount_amount, shipping_fee, membership_tier_at_checkout
) VALUES
(1001,'user001','2024-09-02', 5400,'completed',6000, 600, 0,(SELECT COALESCE(d.membership,'BASIC') FROM user_detail_tbl d WHERE d.user_id='user001' LIMIT 1)),
(1002,'user002','2024-09-02', 8400,'pending', 6000, 600, 3000,(SELECT COALESCE(d.membership,'BASIC') FROM user_detail_tbl d WHERE d.user_id='user002' LIMIT 1)),
(1003,'user003','2024-09-02',13500,'shipped',15000, 1500, 0, (SELECT COALESCE(d.membership,'BASIC') FROM user_detail_tbl d WHERE d.user_id='user003' LIMIT 1));

-- --------------------------
-- 주문 상세
-- --------------------------
INSERT INTO order_detail_tbl (order_code, product, quantity, price) VALUES
(1001, '유기농 사과 1kg', '2', '6000'),
(1002, '브로콜리 400g 1송이', '1', '3500'),
(1003, '연어 300g', '1', '25000');

-- --------------------------
-- 초기 채팅 세션
-- --------------------------
INSERT INTO chat_sessions (session_id, user_id, status) VALUES
('demo_session_001', 'user001', 'active'),
('demo_session_002', 'anonymous', 'active');
