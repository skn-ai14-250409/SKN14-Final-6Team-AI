<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qook - {{ page_title }}</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/static/css/fixed-navigation.css" rel="stylesheet">
    <link href="/static/css/chat.css" rel="stylesheet">
    <link href="/static/css/mypage.css" rel="stylesheet">
    <link href="/static/css/markdown.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- Í≥†Ï†ï ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Î∞î -->
    <header class="fixed-nav-bar">
        <div class="fixed-nav-content">
            <!-- Î°úÍ≥† -->
            <a href="/" class="nav-logo">
                <img src="{{ url_for('static', path='/images/qook_logo.png') }}" alt="Qook Î°úÍ≥†">
                Qook
            </a>
            
            <!-- Ï§ëÏïô ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Î≤ÑÌäº -->
            <div class="nav-buttons">
                <button id="navChatbot" class="nav-tab active" onclick="switchToPage('chatbot')">
                    <i class="fas fa-robot"></i>
                    Ï±óÎ¥á
                </button>
                <button id="navMypage" class="nav-tab" onclick="switchToPage('mypage')">
                    <i class="fas fa-user"></i>
                    ÎßàÏù¥ÌéòÏù¥ÏßÄ
                </button>
            </div>
            
            <!-- Ïö∞Ï∏° Ïï°ÏÖò -->
            <div class="nav-actions">
                {% if current_user %}
                    <button class="nav-action-btn" title="Î©§Î≤ÑÏã≠">
                        <i class="fas fa-gem"></i>
                    </button>
                    <span class="text-white text-sm">{{ current_user }}</span>
                    <button onclick="logout()" class="nav-action-btn" title="Î°úÍ∑∏ÏïÑÏõÉ">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                {% else %}
                    <a href="/login" class="nav-action-btn" title="Î°úÍ∑∏Ïù∏">
                        <i class="fas fa-sign-in-alt"></i>
                    </a>
                {% endif %}
            </div>
        </div>
    </header>
    
    <!-- ÏΩòÌÖêÏ∏† ÏòÅÏó≠ -->
    <div class="content-area">
        <div class="page-slider show-chatbot" id="pageSlider">
            <!-- Ï±óÎ¥á ÌéòÏù¥ÏßÄ -->
            <div class="page-slide" id="chatbotPage">
                <div class="page-content-wrapper">
                    <!-- Ï±óÎ¥á ÏΩòÌÖêÏ∏†Í∞Ä Ïó¨Í∏∞Ïóê Îì§Ïñ¥Í∞à ÏòàÏ†ï -->
                    <div class="flex h-full px-10 md:px-16 lg:px-24 xl:px-40 2xl:px-56">
                        <!-- Ï¢åÏ∏°: Ï±ÑÌåÖ Ïπ¥Îìú -->
                        <div class="flex-1 flex flex-col min-h-0">
                            <div class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden flex-1 flex flex-col min-h-0 mt-6">
                                <!-- Ï±óÎ¥á Ìó§Îçî (Í∞ÑÏÜåÌôî) -->
                                <div class="bg-gradient-to-r from-green-50 to-blue-50 px-6 py-4 flex items-center justify-between border-b border-gray-200">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                            <i class="fas fa-robot text-green-600"></i>
                                        </div>
                                        <div>
                                            <h1 class="text-gray-800 font-bold text-lg">AI Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏</h1>
                                            <p class="text-gray-600 text-sm">Ïã†ÏÑ†Ìïú ÎèÑÏõÄÏùÑ ÎìúÎ¶¥Í≤åÏöî! ü•¨</p>
                                        </div>
                                    </div>
                                    
                                    <button id="clearChat" class="text-gray-600 hover:text-green-600 transition p-2" title="Ï±ÑÌåÖ ÏßÄÏö∞Í∏∞">
                                        <i class="fas fa-refresh"></i>
                                    </button>
                                </div>
                                
                                <!-- Ï±óÎ¥á ÏΩòÌÖêÏ∏† ÏòÅÏó≠ ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî -->
                                <div class="flex-1 flex items-center justify-center">
                                    <div class="text-center text-gray-500">
                                        <i class="fas fa-robot text-4xl mb-4 text-green-500"></i>
                                        <p class="text-lg font-medium mb-2">Ï±óÎ¥á Ï§ÄÎπÑ Ï§ë...</p>
                                        <p class="text-sm">Í≥ß ÎåÄÌôîÎ•º ÏãúÏûëÌï† Ïàò ÏûàÏäµÎãàÎã§</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ïö∞Ï∏°: ÏÇ¨Ïù¥ÎìúÎ∞î (Í∞ÑÏÜåÌôî) -->
                        <div class="w-96 bg-white sidebar-shadow overflow-y-auto rounded-2xl ring-1 ring-gray-200 mt-6 ml-4">
                            <div class="border-b border-gray-200 p-4">
                                <h2 class="font-bold text-gray-800 flex items-center">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    Í¥ÄÎ†® Ï†ïÎ≥¥
                                </h2>
                            </div>
                            
                            <div class="p-4">
                                <div class="text-center text-gray-500">
                                    <i class="fas fa-shopping-basket text-2xl mb-2 text-green-500"></i>
                                    <p class="text-sm">ÏÉÅÌíà Ï∂îÏ≤ú ÎåÄÍ∏∞ Ï§ë</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÎßàÏù¥ÌéòÏù¥ÏßÄ ÌéòÏù¥ÏßÄ -->
            <div class="page-slide" id="mypagePage">
                <div class="page-content-wrapper">
                    <!-- ÎßàÏù¥ÌéòÏù¥ÏßÄ ÏΩòÌÖêÏ∏†Í∞Ä Ïó¨Í∏∞Ïóê Îì§Ïñ¥Í∞à ÏòàÏ†ï -->
                    <div class="min-h-screen bg-gray-50 pt-6">
                        <div class="max-w-7xl mx-auto">
                            <div class="flex">
                                <!-- ÏôºÏ™Ω ÏÇ¨Ïù¥ÎìúÎ∞î -->
                                <div class="w-80 bg-green-500 min-h-screen rounded-l-2xl">
                                    <div class="p-8">
                                        <!-- ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ ÏÑπÏÖò -->
                                        <div class="text-center mb-8">
                                            <div class="w-24 h-24 bg-gray-600 rounded-full mx-auto mb-4 flex items-center justify-center">
                                                <i class="fas fa-user text-white text-3xl"></i>
                                            </div>
                                            <h2 class="text-2xl font-bold text-white mb-4">ÌôçÍ∏∏Îèô Îãò</h2>
                                            <button class="bg-white text-green-600 px-6 py-2 rounded-lg font-semibold hover:bg-gray-100 transition duration-200">
                                                ÌöåÏõêÏ†ïÎ≥¥ ÏàòÏ†ï
                                            </button>
                                        </div>

                                        <!-- Î©îÎâ¥ Î¶¨Ïä§Ìä∏ -->
                                        <div class="space-y-3">
                                            <div class="menu-item flex items-center text-white py-3 px-4 hover:bg-green-400 rounded-lg cursor-pointer transition duration-200 bg-green-600 bg-opacity-30">
                                                <i class="fas fa-clock text-lg mr-4"></i>
                                                <span class="font-medium">Ï£ºÎ¨∏ÎÇ¥Ïó≠ ÌôïÏù∏</span>
                                            </div>
                                            
                                            <div class="menu-item flex items-center text-white py-3 px-4 hover:bg-green-400 rounded-lg cursor-pointer transition duration-200">
                                                <i class="fas fa-truck text-lg mr-4"></i>
                                                <span class="font-medium">Î∞∞ÏÜ°ÎÇ¥Ïó≠ ÌôïÏù∏</span>
                                            </div>
                                            
                                            <div class="menu-item flex items-center text-white py-3 px-4 hover:bg-green-400 rounded-lg cursor-pointer transition duration-200">
                                                <i class="fas fa-comments text-lg mr-4"></i>
                                                <span class="font-medium">Ï±ÑÌåÖ ÌûàÏä§ÌÜ†Î¶¨</span>
                                            </div>
                                            
                                            <div class="menu-item flex items-center text-white py-3 px-4 hover:bg-green-400 rounded-lg cursor-pointer transition duration-200">
                                                <i class="fas fa-utensils text-lg mr-4"></i>
                                                <span class="font-medium">Ï†ÄÏû•Ìïú Î†àÏãúÌîº</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Ïò§Î•∏Ï™Ω Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
                                <div class="flex-1 p-12">
                                    <div class="bg-white rounded-2xl shadow-sm h-full overflow-y-auto rounded-l-none">
                                        <div class="flex items-center justify-center h-full">
                                            <div class="text-center">
                                                <i class="fas fa-user text-4xl mb-4 text-green-500"></i>
                                                <p class="text-lg font-medium mb-2">ÎßàÏù¥ÌéòÏù¥ÏßÄ Ï§ÄÎπÑ Ï§ë...</p>
                                                <p class="text-sm text-gray-500">Í∞úÏù∏ Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§Í≥† ÏûàÏäµÎãàÎã§</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="/static/js/fixed-navigation.js"></script>
    
    <!-- Î°úÍ∑∏ÏïÑÏõÉ Í∏∞Îä• -->
    <script>
        async function logout() {
            try {
                const response = await fetch('/auth/logout', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'include'
                });
                
                if (response.ok) {
                    const u = JSON.parse(localStorage.getItem('user_info')||'{}');
                    const uid = u.user_id || '';
                    localStorage.removeItem('access_token');
                    if (uid){
                        localStorage.removeItem(`chat_messages_${uid}`);
                        localStorage.removeItem(`chat_session_${uid}`);
                        localStorage.removeItem(`chat_pending_message_${uid}`);
                    }
                    localStorage.removeItem('user_info');
                    window.location.href = '/';
                } else {
                    console.error('Î°úÍ∑∏ÏïÑÏõÉ Ïã§Ìå®');
                }
            } catch (error) {
                console.error('Î°úÍ∑∏ÏïÑÏõÉ Ïò§Î•ò:', error);
            }
        }
    </script>
</body>
</html>
